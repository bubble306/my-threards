<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Echo 连接诊断</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="font-family: sans-serif; padding: 20px;">
    <h2>Echo 数据库诊断台</h2>
    <div id="status" style="padding: 10px; background: #eee; margin-bottom: 10px;">正在连接...</div>
    
    <div id="debug-info" style="color: red; margin-bottom: 20px;"></div>

    <button onclick="testPost()" style="padding: 10px 20px;">点击强行发帖测试</button>

    <script>
        // 记得在这里替换你的信息！
        const SUPABASE_URL = 'https://fzxucsdptrikazqvdnlv.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ6eHVjc2RwdHJpa2F6cXZkbmx2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMzU0NjYsImV4cCI6MjA4NTkxMTQ2Nn0.ZChcBRbRorV7pHrQmGd0MV_A2x4fz8_h55-lMqvHhNY'; 

        const client = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function check() {
            const statusEl = document.getElementById('status');
            const debugEl = document.getElementById('debug-info');
            
            try {
                // 尝试最简单的查询
                const { data, error } = await client.from('posts').select('id').limit(1);
                
                if (error) {
                    statusEl.innerText = "❌ 连接失败";
                    debugEl.innerText = "错误详情: " + error.message;
                } else {
                    statusEl.innerText = "✅ 连接成功！数据库已通。";
                    debugEl.style.color = "green";
                    debugEl.innerText = "你的配置没问题，可以换回美化版代码了。";
                }
            } catch (err) {
                statusEl.innerText = "❌ 浏览器报错";
                debugEl.innerText = "系统错误: " + err.message;
            }
        }

        async function testPost() {
            const { error } = await client.from('posts').insert([{ content: '测试数据', user_name: '诊断器' }]);
            if (error) alert("发帖失败: " + error.message);
            else alert("发帖成功！");
        }

        check();
    </script>
</body>
</html>















