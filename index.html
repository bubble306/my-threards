async function send() {
    const name = document.getElementById('nickname').value || '匿名';
    const val = document.getElementById('t').value;
    const file = document.getElementById('fileInput').files[0];
    let finalImageUrl = null; // 默认是空

    if (file) {
        const fileName = Date.now() + '-' + file.name;
        // 1. 先上传文件
        const { data, error } = await client.storage.from('images').upload(fileName, file);
        if (error) {
            console.error("上传失败:", error);
            alert("上传失败: " + error.message);
            return;
        }
        // 2. 拿到这个文件的网络地址
        const { data: { publicUrl } } = client.storage.from('images').getPublicUrl(fileName);
        finalImageUrl = publicUrl;
    }

    // 3. 把地址存进数据库
    const { error: dbError } = await client.from('posts').insert([{ 
        content: val, 
        user_name: name, 
        likes: 0, 
        image_url: finalImageUrl 
    }]);

    if(dbError) {
        console.error("存入数据库失败:", dbError);
    } else {
        location.reload(); 
    }
}





